NEEDS FIXING
=============
* Pressing any key sends request to server. Just do it only when something changes in the editor. Ignore all other key events.
* Enter key is inserting the selected text and moving to next line. This is inconvenient. So process enter key if popup is not visible.